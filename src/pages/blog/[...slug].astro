---
import { getCollection } from 'astro:content';
import RelatedContent from '../../components/RelatedContent.astro';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
    const posts = await getCollection('blog');
    return posts.map(post => ({
        params: { slug: post.slug },
        props: { post },
    }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title}>
    <article class="post">
        <header>
            <h1>{post.data.title}</h1>
            <p class="meta">
                <time datetime={post.data.date.toISOString()}>
                    {post.data.date.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    })}
                </time>
                <span> â€¢ </span>
                <span>{post.data.category}</span>
            </p>
            {post.data.image && (
                <img 
                    src={post.data.image} 
                    alt={post.data.title} 
                    width="800" 
                    height="450"
                />
            )}
        </header>

        <Content />

        <RelatedContent 
            currentPost={{
                category: post.data.category,
                slug: post.slug
            }} 
        />
    </article>
</Layout>

<style>
    .post {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem 1rem;
    }
    
    .post header {
        margin-bottom: 2rem;
    }
    
    .post h1 {
        font-size: 2.5rem;
        margin: 0 0 1rem 0;
        line-height: 1.2;
    }
    
    .meta {
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 2rem;
    }
    
    .post img {
        width: 100%;
        height: auto;
        border-radius: 8px;
    }
</style>
